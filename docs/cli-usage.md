# CLI Usage

The Release Copilot CLI accepts configuration from YAML files, environment variables, and direct flags. Configuration precedence is:

1. Command line arguments (highest priority)
2. Environment variables
3. YAML defaults (`releasecopilot.yaml`)

Secrets follow the same order, and when `--use-aws-secrets-manager` is provided the CLI falls back to AWS Secrets Manager for any missing values. Secrets retrieved from AWS are cached so that each key is only fetched once per run.

## Running the CLI

```bash
python main.py --config releasecopilot.yaml --fix-version 2025.09.27
```

Any CLI flag can override both environment variables and YAML defaults. For example, set `JIRA_BASE` in your environment but override it for a one-off run using `--jira-base`.

## Providing Secrets

Provide secrets through CLI flags (e.g., `--jira-token`, `--bitbucket-token`) or matching environment variables (`JIRA_TOKEN`, `BITBUCKET_TOKEN`). If a secret is still missing and AWS fallback is enabled, Release Copilot will request the value from AWS Secrets Manager using the same key name.

To enable the fallback, pass `--use-aws-secrets-manager` or set the environment variable `USE_AWS_SECRETS_MANAGER=true`.

## Recovery Mode

If the main pipeline completes its data collection phase but fails before exporting artifacts, you can rebuild the outputs from
the cached JSON files using `recover_and_export.py`. The tool reads the intermediate payloads stored in `temp_data/` and
produces the same Excel workbook and JSON summary generated by the normal export stage.

```bash
python recover_and_export.py --input-dir temp_data --format excel
```

The command above regenerates only the Excel workbook in the default output directory `reports/`. By default the utility writes
both `audit_results.xlsx` and `audit_results.json` (alongside `summary.json`) to the selected output folder, mirroring the
filenames created by the primary CLI.
